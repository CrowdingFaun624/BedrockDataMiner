{
    "group_aliases": {
        "a": "structures/misc/types",
        "misc": "structures/misc/misc",
        "temp": "structures/misc/template",
        "vector": "structures/misc/vector"
    },
    "base": {
        "inherit": "temp/base_multiple_pack_files",
        "$name": "structures",
        "$pack_type": "pack", // is resource pack before 17w43a
        "$types": "a/compound",
        "$serializer": "minecraft_common!serializers/nbt_big",
        "$structure": "root"
    },
    "root": {
        "inherit": "temp/SortedKeymap.nbt",
        "keys": {
            "version": {"types": "a/int"},
            "DataVersion": {"types": "a/int", "delegate_arguments": {"always_print": true}},
            "author": {"types": "a/string"},
            "size": {"types": "a/list", "structure": "vector/vector.tag_int"},
            "palette": {"types": "a/list", "structure": "palette"},
            "palettes": {"types": "a/list", "structure": "palettes"},
            "blocks": {"types": "a/list", "structure": "blocks"},
            "entities": {"types": "a/list", "structure": "entities"}
        }
    },
    "palettes": {
        "inherit": "temp/Set.nbt",
        "$field": "palette",
        "value_types": "a/list",
        "value_structure": "palette"
    },
    "palette": {
        "inherit": "temp/List.nbt", // indexes are VERY important
        "$field": "block",
        "value_types": "a/compound",
        "value_structure": "block_state"
    },
    "block_state": {
        "inherit": "temp/SortedKeymap.nbt",
        "keys": {
            "Name": {"types": "a/string"},
            "Properties": {"types": "a/compound", "structure": "block_state.properties"}
        }
    },
    "block_state.properties": {
        "inherit": "temp/Dict.nbt",
        "$field": "property",
        "value_types": "a/string",
        "value_structure": null
    },
    "blocks": {
        "type": "Condition",
        "substructures": [
            {"types": "a/list", "filter": {"type": "EqFilter", "key": "old_blocks", "value": false, "default": true}, "structure": "blocks:new"},
            {"types": "a/list", "filter": {"type": "EqFilter", "key": "old_blocks", "value": true}, "structure": "blocks:old"}
        ]
    },
    "blocks:old": {
        "type": "Normalizer",
        "outer_types": "a/list",
        "inner_types": "dict",
        "functions": {
            "function_name": "minecraft_common!normalizers/volume_normalize_nbt volume_normalize_nbt_old"
        },
        "structure": {
            "type": "Keymap",
            "delegate": "minecraft_common!VolumeDelegate",
            "delegate_arguments": {
                "field": "block"
            },
            "keys": {
                "states": {"types": "dict", "structure": "volume_states"},
                "data": {"types": "dict", "structure": "volume_additional_data"},
                "palette": {"types": "dict", "structure": "very_old_palette"},
                "size": {"types": "tuple", "structure": "vector/vector.tuple_int"}
            }
        }
    },
    "very_old_palette": {
        "inherit": "temp/Dict",
        "$field": "character",
        "key_weight": 0,
        "value_types": "dict",
        "value_structure": "very_old_palette:item"
    },
    "very_old_palette:item": {
        "inherit": "temp/SortedKeymap",
        "keys": {
            "block_id": {"types": "int", "delegate_arguments": {"always_print": true}, "similarity_weight": 5},
            "data": {"types": "int"}
        }
    },
    "blocks:new": {
        "type": "Normalizer",
        "outer_types": "a/list",
        "inner_types": "dict",
        "functions": {
            "function_name": "minecraft_common!normalizers/volume_normalize_nbt volume_normalize_nbt",
            "arguments": {
                "position_key": "pos",
                "state_key": "state"
            }
        },
        "structure": {
            "type": "Keymap",
            "delegate": "minecraft_common!VolumeDelegate",
            "delegate_arguments": {
                "field": "block"
            },
            "keys": {
                "states": {"types": "dict", "structure": "volume_states"},
                "data": {"types": "dict", "structure": "volume_additional_data"},
                "size": {"types": "tuple", "structure": "vector/vector.tuple_int"}
            }
        }
    },
    "volume_states": {
        "type": "Dict",
        "allow_key_moves": false,
        "key_types": "tuple",
        "value_types": "int",
        "delegate": null,
        "value_structure": null
    },
    "volume_additional_data": {
        "type": "Dict",
        "allow_key_moves": false,
        "key_types": "tuple",
        "value_types": "a/compound",
        "delegate": null,
        "value_structure": "block"
    },
    "block": {
        "inherit": "temp/SortedKeymap.nbt",
        "keys": {
            "nbt": {"types": "a/compound", "structure": "structures/misc/block_entity/block_entity"}
        }
    },
    "entities": {
        "inherit": "temp/Set.nbt",
        "$field": "entity",
        "value_types": "a/compound",
        "value_structure": "entity"
    },
    "entity": {
        "inherit": "temp/SortedKeymap.nbt",
        "keys": {
            "pos": {"types": "a/list", "structure": "vector/vector.tag_double"},
            "blockPos": {"types": "a/list", "structure": "vector/vector.tag_int"},
            "nbt": {"types": "a/compound", "structure": "structures/misc/entity/entity"}
        }
    }
}